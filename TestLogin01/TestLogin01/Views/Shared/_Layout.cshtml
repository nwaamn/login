<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - TestLogin01</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" />
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
            <div class="container">
                <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">TestLogin01</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse">
                    <ul class="navbar-nav flex-grow-1">
                        <li class="nav-item">
                            <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Index">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
                        </li>
                        <li class="nav-item align-self-center" id="user-display">
                            <a class="nav-link text-dark" data-toggle="modal" data-target="#login">
                                Login
                                <script>
                                    function checkLogin() {
                                        var username = localStorage.setItem('sj_username')
                                        if (username == null) {
                                            document.getElementById('user-display').innerHTML = '<a class="nav-link" href="#login" data-toggle="modal"><img src="./image/user.svg" width="25px" height="25px"></a>'
                                        } else {
                                            document.getElementById('user-display').innerHTML = '<div class="dropdown">' +
                                                '<a class="dropdown-toggle pointer text-white" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">' +
                                                '<p class="mb-0 pr-2 d-inline-block text-limit-100px">' + username + '</p></a>' +
                                                '<div class="dropdown-menu dropdown-menu-right mt-2" aria-labelledby="dropdownMenuLink">' +
                                                '<a class="dropdown-item pointer" onClick="handleLogout();"><i class="fa fa-sign-out mr-2 pr-1"></i>ออกจากระบบ</a>' +
                                                '</div></div>'
                                        }
                                    }
                                    checkLogin()
                                </script>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    <div class="modal fade" id="login" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content rounded-0">
                <ul class="nav nav-pills nav-fill mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-login nav-link rounded-0 text-green" id="btn-register" data-toggle="pill"
                           href="#tab-register" role="tab" aria-controls="tab-register" aria-selected="true">
                            <h5>Register</h5>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-login nav-link active rounded-0 text-green" id="btn-login" data-toggle="pill"
                           href="#tab-login" role="tab" aria-controls="tab-login" aria-selected="false">
                            <h5>Login</h5>
                        </a>
                    </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade" id="tab-register" role="tabpanel" aria-labelledby="pills-home-tab">
                        <div class="modal-body px-4">
                            <h3 class="text-center text-muted mb-4">Create Account</h3>
                            <div class="input-group mb-3 px-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text rounded-0 border-top-0 border-left-0 border-right-0 bg-white"
                                          id="basic-addon1"><i class="fa fa-envelope-o"></i></span>
                                </div>
                                <input type="text"
                                       class="form-control rounded-0 border-top-0 border-left-0 border-right-0"
                                       placeholder="Email" aria-label="Email" aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-3 px-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text rounded-0 border-top-0 border-left-0 border-right-0 bg-white"
                                          id="basic-addon1"><i class="fa fa-key"></i></span>
                                </div>
                                <input type="password"
                                       class="form-control rounded-0 border-top-0 border-left-0 border-right-0"
                                       placeholder="Password" aria-label="Password" aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-3 px-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text rounded-0 border-top-0 border-left-0 border-right-0 bg-white"
                                          id="basic-addon1"><i class="fa fa-lock"></i></span>
                                </div>
                                <input type="password"
                                       class="form-control rounded-0 border-top-0 border-left-0 border-right-0"
                                       placeholder="Confirm password" aria-label="Confirm password"
                                       aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-4 px-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text rounded-0 border-top-0 border-left-0 border-right-0 bg-white"
                                          id="basic-addon1"><i class="fa fa-user"></i></span>
                                </div>
                                <input type="text"
                                       class="form-control rounded-0 border-top-0 border-left-0 border-right-0"
                                       placeholder="Username" aria-label="Username" aria-describedby="basic-addon1">
                            </div>


                            <div class="form-group px-3">
                                <button type="submit" class="btn btn-info btn-block ">Register</button>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane show active fade" id="tab-login" role="tabpanel"
                         aria-labelledby="pills-profile-tab">
                        <form class="modal-body px-4" id="login-form">
                            <h3 class="text-center text-muted mb-4">Welcome to IX</h3>
                            <div class="input-group mb-3 px-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text rounded-0 border-top-0 border-left-0 border-right-0 bg-white"
                                          id="basic-addon1"><i class="fa fa-envelope-o"></i></span>
                                </div>
                                <input type="text" id="login-email" required
                                       class="form-control rounded-0 border-top-0 border-left-0 border-right-0"
                                       placeholder="Email" aria-label="Email" aria-describedby="basic-addon1">
                            </div>
                            <div class="input-group mb-3 px-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text rounded-0 border-top-0 border-left-0 border-right-0 bg-white"
                                          id="basic-addon1"><i class="fa fa-key"></i></span>
                                </div>
                                <input type="password" id="login-password" required
                                       class="form-control rounded-0 border-top-0 border-left-0 border-right-0"
                                       placeholder="Password" aria-label="Password" aria-describedby="basic-addon1">
                            </div>
                            <div class="mb-4 px-3">
                                <div class="form-group form-check text-muted">
                                    <input type="checkbox" class="form-check-input" id="remember">
                                    <label class="form-check-label" for="remember">Remember me</label>
                                </div>
                            </div>
                            <div class="form-group px-3">
                                <button type="button" class="btn btn-info btn-block"
                                        onclick="handleLogin();" asp-controller="Home" asp-action="Privacy">
                                    Login
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="border-top footer text-muted">
        <div class="container">
            &copy; 2020 - TestLogin01 - <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
        </div>
    </footer>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @RenderSection("Scripts", required: false)

    <script>
        function handleLogin() {
            var valid = Valid.form('login-form')
            if (valid) {
                localStorage.setItem('xi_username', document.getElementById('login-email').value)
                checkLogin()
                document.getElementById('login').classList.remove('show')
                document.body.removeAttribute("style")
                document.body.classList.remove('modal-open')
                document.getElementsByClassName('modal-backdrop')[0].remove()
            }
        }

        function handleLogout() {
            localStorage.removeItem('xi_username')
            checkLogin()
        }

        function handleMove(vector) {
            var leftPos = $('#product-list').scrollLeft();
            if (vector == 'right') {
                $("#product-list").animate({ scrollLeft: leftPos + document.getElementById('product-list').offsetWidth }, 500);
            } else {
                $("#product-list").animate({ scrollLeft: leftPos - document.getElementById('product-list').offsetWidth }, 500);
            }
        }
    </script>
</body>
</html>
